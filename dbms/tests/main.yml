---
# TODO move this into role
- name: test postgresql12 role
  hosts: dbms
  pre_tasks:
    - name: package_facts uses auto, setup for next task
      package_facts:
        manager: "auto"

  tasks:
    - name: verify PostgreSQL server is installed correctly
      assert:
        that:
          - "'postgresql' in ansible_facts.packages"

    - debug:
        msg: TODO verify postgresql-client is installed

    - debug:
        msg: TODO verify python3-psycopg2 is installed

    - debug:
        msg: TODO verify locale en_US.UTF-8 exists

    - debug:
        msg: TODO test configure.yml

    - debug:
        msg: TODO test replication.yml


- name: Test Set up primary DBMS
  hosts: localhost
  gather_facts: false
  run_once: true
  tasks:
    - debug:
        msg: TODO implement


- name: Test Set up replica DBMSs
  hosts: localhost
  gather_facts: false
  run_once: true
  tasks:
    - debug:
        msg: TODO implement
