#!/usr/bin/env bash
#
# This script builds the ansible-tester image.


if [[ "$OSTYPE" == "darwin"* ]]
then
  readonly ExecName=$(greadlink -f "$0")
else
  readonly ExecName=$(readlink --canonicalize "$0")
fi

declare BaseDir


main()
{
  BaseDir="$(dirname "$ExecName")"

  cp --no-clobber "$BaseDir"/../../requirements.yml "$BaseDir"/requirements.yml
  trap 'rm --force "$BaseDir"/requirements.yml' EXIT
  docker build --tag ansible-tester "$BaseDir"
}


set -e

main "$@"
